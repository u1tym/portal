WEBアプリケーション
DBはPostgreSQL
バックエンドはPythonで、FastAPIで、型のヒント句をつけて
フロントはVue3、typescript

DBに以下のテーブルをもつ

ユーザ管理用テーブル
ユーザID、ユーザ名、パスワード
ゆーざIDがプリマリーキー
ユーザ名はユニーク
パスワードはNOT NULL

セッション管理テーブル
ユーザID、キー値、セッション文字列、最終アクセス日時
ユーザIDとキー値がプライマリーキー
最終アクセス日時はNOT NULL

コンテンツ管理テーブル
ユーザID、表示順、コンテンツタイトル、遷移先URL
ユーザIDと表示順がプライマリーキー
遷移先URLはNOT NULL


ログインページは、以下のような画面
ユーザ名入力欄
パスワード入力欄
ログインボタン

ログインボタンを押したときの処理は以下
フロントエンドからバックエンドに、キー値取得として、ユーザ名を送信し、応答を待つ。
応答が異常の場合には、エラー内容をダイアログに出して終了。
応答が正常の場合には、入力されたパスワードを、取得したキー値で、ハッシュ値を生成する。
そして、フロントエンドからバックエンドに、ログイン認証として、ユーザ名、キー値、生成したハッシュ値を送信し、応答を待つ。
応答が異常の場合には、エラー内容をダイアログに出して終了。
応答が正常の場合には、セッション文字列と遷移先URLを取得するので、セッション文字列を保存し、遷移先URLに遷移する。

バックエンドの処理は以下

キー値取得では、フロントエンドからユーザ名が送信されてくるので、ユーザ管理テーブルを検索する。
該当ユーザが無ければ、異常応答で、アカウント不正を返す。
該当ユーザがある場合には、ランダムのキー値を生成して、セッション管理テーブルにレコードを追加する。このときのセッション文字列はNULLにする。また、フロントエンドに正常応答で、キー値を返す。

ログイン認証では、フロントエンドから、ユーザ名、キー値、ハッシュ値が送信されてくる。
ユーザ管理テーブルを検索して、無ければ、異常応答で、アカウント不正を返す。
セッション管理テーブルを検索して、ユーザID、キー値で一致するものがないときは、異常応答で、アカウント不正を返す。
フロントエンドから通知されてきたハッシュ値と、フロントエンドから通知されたユーザ名で検索したパスワードと、フロントエンドから通知されたキー値で算出したハッシュ値を比較し、同一でない場合には、異常応答で、アカウント不正を返す。
同一の場合は、コンテンツ管理テーブルを検索し、表示順が0の遷移先URLを取得する。
該当レコードがない場合には、異常応答で、内部処理異常を返す。
ランダム文字列を生成し、セッション文字列として、セッション管理テーブルを更新する。また、セッション文字列と遷移先URLをフロントエンドに返す。









